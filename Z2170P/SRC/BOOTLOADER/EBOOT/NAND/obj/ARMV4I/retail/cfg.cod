; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\Z2170P\SRC\BOOTLOADER\EBOOT\NAND\cfg.c
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "


  00000			 AREA	 |.data|, DATA
	 COMMON	|ghTwl|, 0x4


  00000			 AREA	 |.rdata|, DATA, READONLY
|EdbgVendorIds| DCW 0x0
	DCW	0x0
	DCD	0x4033
	DCB	0x1
	DCB	"AD", 0x0
	DCW	0x1050
	DCW	0x940
	DCD	0x4005
	DCB	0x1
	DCB	"LS", 0x0
	DCW	0x1050
	DCW	0x940
	DCD	0x2078
	DCB	0x1
	DCB	"LS", 0x0
	DCW	0x10ec
	DCW	0x8029
	DCD	0xc0f0
	DCB	0x1
	DCB	"KS", 0x0
	DCW	0x10ec
	DCW	0x8129
	DCD	0x0
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x10ec
	DCW	0x8139
	DCD	0x900b
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x10ec
	DCW	0x8139
	DCD	0xd0c9
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x10ec
	DCW	0x8139
	DCD	0xe04c
	DCB	0x4
	DCB	"RT", 0x0
	DCW	0x1186
	DCW	0x1300
	DCD	0x50ba
	DCB	0x4
	DCB	"DL", 0x0
	DCW	0x100b
	DCW	0x20
	DCD	0xa0cc
	DCB	0x5
	DCB	"NG", 0x0
	DCW	0x10b7
	DCW	0x9050
	DCD	0x6008
	DCB	0x6
	DCB	"3C", 0x0
	DCW	0x10b7
	DCW	0x9200
	DCD	0x476
	DCB	0x6
	DCB	"3C", 0x0
	EXPORT	|__$ArrayPad$| [ DATA ]
	EXPORT	|BLReadBootCfg|
	EXPORT	|??_C@_1HE@BDJAOKHO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAR?$AAe?$AAa?$AAd?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DK@HPMHIIMH@?$AAB?$AAL?$AAR?$AAe?$AAa?$AAd?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AA?$DN?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1IG@EBGBGDAI@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs?$AAh?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAb?$AAy?$AAt?$AAe@| [ DATA ] ; `string'
	EXPORT	|??_C@_1EE@MHCJNGAF@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAG?$AAe?$AAt?$AAI?$AAn?$AAf?$AAo?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DO@FFNONGBO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAI?$AAn?$AAi?$AAt?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	IMPORT	|FMD_Deinit|
	IMPORT	|FMD_ReadSector|
	IMPORT	|FMD_GetBlockStatus|
	IMPORT	|FMD_GetInfo|
	IMPORT	|NKDbgPrintfW|
	IMPORT	|dpCurSettings|
	IMPORT	|FMD_Init|
	IMPORT	|g_ulFlashBase|
	IMPORT	|__GSHandlerCheck|
	IMPORT	|__security_cookie|
	IMPORT	|memcpy|
	IMPORT	|__security_check_cookie|
; File c:\wince600\platform\z2170p\src\bootloader\eboot\nand\cfg.c

  00000			 AREA	 |.pdata|, PDATA
|$T47025| DCD	|$LN23@BLReadBoot|
	DCD	0xc0006703

  00000			 AREA	 |.xdata|, DATA
|$T47021| DCD	0xffffffe4

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1HE@BDJAOKHO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAR?$AAe?$AAa?$AAd?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "E", 0x0, "B", 0x0, "O", 0x0, "O", 0x0, "T", 0x0, "!"
	DCB	0x0, "B", 0x0, "L", 0x0, "R", 0x0, "e", 0x0, "a", 0x0, "d"
	DCB	0x0, "B", 0x0, "o", 0x0, "o", 0x0, "t", 0x0, "C", 0x0, "f"
	DCB	0x0, "g", 0x0, ":", 0x0, " ", 0x0, "F", 0x0, "l", 0x0, "a"
	DCB	0x0, "s", 0x0, "h", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "c"
	DCB	0x0, "t", 0x0, "o", 0x0, "r", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, " ", 0x0, "r", 0x0, "e", 0x0, "a", 0x0, "d", 0x0, " "
	DCB	0x0, "f", 0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DK@HPMHIIMH@?$AAB?$AAL?$AAR?$AAe?$AAa?$AAd?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AA?$DN?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| DCB "B"
	DCB	0x0, "L", 0x0, "R", 0x0, "e", 0x0, "a", 0x0, "d", 0x0, "B"
	DCB	0x0, "o", 0x0, "o", 0x0, "t", 0x0, "C", 0x0, "f", 0x0, "g"
	DCB	0x0, ":", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "c", 0x0, "t"
	DCB	0x0, "o", 0x0, "r", 0x0, " ", 0x0, "=", 0x0, " ", 0x0, "%"
	DCB	0x0, "d", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1IG@EBGBGDAI@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs?$AAh?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAb?$AAy?$AAt?$AAe@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "F", 0x0, "l", 0x0, "a", 0x0, "s", 0x0, "h", 0x0, " "
	DCB	0x0, "s", 0x0, "e", 0x0, "c", 0x0, "t", 0x0, "o", 0x0, "r"
	DCB	0x0, " ", 0x0, "s", 0x0, "i", 0x0, "z", 0x0, "e", 0x0, " "
	DCB	0x0, "%", 0x0, "d", 0x0, " ", 0x0, "b", 0x0, "y", 0x0, "t"
	DCB	0x0, "e", 0x0, "s", 0x0, " ", 0x0, "b", 0x0, "i", 0x0, "g"
	DCB	0x0, "g", 0x0, "e", 0x0, "r", 0x0, " ", 0x0, "t", 0x0, "h"
	DCB	0x0, "a", 0x0, "n", 0x0, " ", 0x0, "s", 0x0, "u", 0x0, "p"
	DCB	0x0, "p", 0x0, "o", 0x0, "r", 0x0, "t", 0x0, "e", 0x0, "d"
	DCB	0x0, " ", 0x0, "%", 0x0, "d", 0x0, " ", 0x0, "b", 0x0, "y"
	DCB	0x0, "t", 0x0, "e", 0x0, "s", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1EE@MHCJNGAF@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAG?$AAe?$AAt?$AAI?$AAn?$AAf?$AAo?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "F", 0x0, "M", 0x0, "D", 0x0, "_", 0x0, "G", 0x0, "e"
	DCB	0x0, "t", 0x0, "I", 0x0, "n", 0x0, "f", 0x0, "o", 0x0, " "
	DCB	0x0, "c", 0x0, "a", 0x0, "l", 0x0, "l", 0x0, " ", 0x0, "f"
	DCB	0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d", 0x0, "!"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DO@FFNONGBO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAI?$AAn?$AAi?$AAt?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN?$AA?6?$AA?$AA@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "F", 0x0, "M", 0x0, "D", 0x0, "_", 0x0, "I", 0x0, "n"
	DCB	0x0, "i", 0x0, "t", 0x0, " ", 0x0, "c", 0x0, "a", 0x0, "l"
	DCB	0x0, "l", 0x0, " ", 0x0, "f", 0x0, "a", 0x0, "i", 0x0, "l"
	DCB	0x0, "e", 0x0, "d", 0x0, "!", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__GSHandlerCheck|
  00004	00000000	 DCD         |$T47021|

  00008		 |BLReadBootCfg| PROC

; 26   : {

  00008		 |$LN23@BLReadBoot|
  00008	e92d41f0	 stmdb       sp!, {r4 - r8, lr}
  0000c	e59fc18c	 ldr         r12, [pc, #0x18C]
  00010	e08dd00c	 add         sp, sp, r12
  00014		 |$M47022|
  00014	e1a07000	 mov         r7, r0
  00018	e59f317c	 ldr         r3, [pc, #0x17C]
  0001c	e5933000	 ldr         r3, [r3]
  00020	e58d3b98	 str         r3, [sp, #0xB98]

; 27   :     BOOL rc = FALSE;
; 28   :     HANDLE hFMD;
; 29   :     PCI_REG_INFO regInfo;
; 30   :     FlashInfo flashInfo;
; 31   :     SectorInfo sectorInfo;
; 32   :     SECTOR_ADDR sector;
; 33   :     BLOCK_ID block;
; 34   :     UINT32 count, offset;
; 35   :     UINT8 buffer[2048];
; 36   :     
; 37   : 
; 38   :     // EBOOT configuration is placed in last sector of EBOOT image
; 39   :     regInfo.MemBase.Reg[0] = g_ulFlashBase;

  00024	e59f316c	 ldr         r3, [pc, #0x16C]

; 40   :     hFMD = FMD_Init(NULL, &regInfo, NULL);

  00028	e3a02000	 mov         r2, #0
  0002c	e28d1018	 add         r1, sp, #0x18
  00030	e5933000	 ldr         r3, [r3]
  00034	e3a00000	 mov         r0, #0
  00038	e3a06000	 mov         r6, #0
  0003c	e58d3328	 str         r3, [sp, #0x328]
  00040	eb000000	 bl          FMD_Init
  00044	e1b08000	 movs        r8, r0

; 41   :     if (hFMD == NULL)

  00048	1a000006	 bne         |$LN8@BLReadBoot|

; 42   :         {
; 43   :         OALMSG(OAL_ERROR, (L"ERROR: FMD_Init call failed!\r\n"));

  0004c	e59f3130	 ldr         r3, [pc, #0x130]
  00050	e5933440	 ldr         r3, [r3, #0x440]
  00054	e3130001	 tst         r3, #1
  00058	0a000040	 beq         |$LN1@BLReadBoot|
  0005c	e59f0130	 ldr         r0, [pc, #0x130]
  00060	eb000000	 bl          NKDbgPrintfW

; 44   :         goto cleanUp;

  00064	ea00003d	 b           |$LN1@BLReadBoot|
  00068		 |$LN8@BLReadBoot|

; 45   :         }
; 46   : 
; 47   :     // Get flash info
; 48   :     if (!FMD_GetInfo(&flashInfo))

  00068	e28d0000	 add         r0, sp, #0
  0006c	eb000000	 bl          FMD_GetInfo
  00070	e3500000	 cmp         r0, #0
  00074	1a000006	 bne         |$LN7@BLReadBoot|

; 49   :         {
; 50   :         OALMSG(OAL_ERROR, (L"ERROR: FMD_GetInfo call failed!\r\n"));

  00078	e59f3104	 ldr         r3, [pc, #0x104]
  0007c	e5933440	 ldr         r3, [r3, #0x440]
  00080	e3130001	 tst         r3, #1
  00084	0a000033	 beq         |$cleanUp$46857|
  00088	e59f0100	 ldr         r0, [pc, #0x100]
  0008c	eb000000	 bl          NKDbgPrintfW

; 51   :         goto cleanUp;

  00090	ea000030	 b           |$cleanUp$46857|
  00094		 |$LN7@BLReadBoot|

; 52   :         }
; 53   : 
; 54   :     // We can support only flash with sector size < 2048 bytes
; 55   :     if (flashInfo.wDataBytesPerSector > sizeof(buffer))

  00094	e1dd10be	 ldrh        r1, [sp, #0xE]
  00098	e3510b02	 cmp         r1, #2, 22
  0009c	9a000007	 bls         |$LN6@BLReadBoot|

; 56   :         {
; 57   :         OALMSG(OAL_ERROR, (L"ERROR: "
; 58   :             L"Flash sector size %d bytes bigger than supported %d bytes\r\n",
; 59   :             flashInfo.wDataBytesPerSector, sizeof(buffer)    
; 60   :             ));

  000a0	e59f30dc	 ldr         r3, [pc, #0xDC]
  000a4	e5933440	 ldr         r3, [r3, #0x440]
  000a8	e3130001	 tst         r3, #1
  000ac	0a000029	 beq         |$cleanUp$46857|
  000b0	e59f00d4	 ldr         r0, [pc, #0xD4]
  000b4	e3a02b02	 mov         r2, #2, 22
  000b8	eb000000	 bl          NKDbgPrintfW

; 61   :         goto cleanUp;

  000bc	ea000025	 b           |$cleanUp$46857|
  000c0		 |$LN6@BLReadBoot|

; 62   :         }
; 63   : 
; 64   :     // Configuration is located in last sector of EBOOT image
; 65   :     offset = IMAGE_XLDR_BOOTSEC_NAND_SIZE + IMAGE_EBOOT_BOOTSEC_NAND_SIZE;
; 66   :     
; 67   :     // Start from beginning
; 68   :     block  = 0;

  000c0	e3a04000	 mov         r4, #0

; 69   :     sector = 0;
; 70   : 
; 71   :     // Skip X-Loader & EBOOT code & bad blocks
; 72   :     // Note that we also check the last eboot block in order to ensure it is good
; 73   :     count = 0;

  000c4	e3a05000	 mov         r5, #0
  000c8		 |$LL5@BLReadBoot|

; 74   :     while ((count < offset) && (block < flashInfo.dwNumBlocks))

  000c8	e59d3004	 ldr         r3, [sp, #4]
  000cc	e1540003	 cmp         r4, r3
  000d0	2a000007	 bcs         |$LN4@BLReadBoot|

; 75   :         {
; 76   :         if ((FMD_GetBlockStatus(block) & BLOCK_STATUS_BAD) == 0)

  000d4	e1a00004	 mov         r0, r4
  000d8	eb000000	 bl          FMD_GetBlockStatus
  000dc	e3100002	 tst         r0, #2

; 77   :             {
; 78   :             count += flashInfo.dwBytesPerBlock;

  000e0	059d3008	 ldreq       r3, [sp, #8]

; 79   :             }
; 80   :         block++;

  000e4	e2844001	 add         r4, r4, #1
  000e8	00855003	 addeq       r5, r5, r3
  000ec	e3550703	 cmp         r5, #3, 14
  000f0	3afffff4	 bcc         |$LL5@BLReadBoot|
  000f4		 |$LN4@BLReadBoot|

; 81   :         }
; 82   : 
; 83   :     // We've incremented past the last eboot block in order to check it too
; 84   :     // Back up now, the previous block is the last one containing eboot and is good
; 85   :     block--;
; 86   : 
; 87   :     //  Compute sector within the block where config lies
; 88   :     sector = block * flashInfo.wSectorsPerBlock;
; 89   :     sector += flashInfo.wSectorsPerBlock - 1;
; 90   : 	OALMSG(1, (L"BLReadBootCfg: sector = %d\r\n",sector));
; 91   :     // Read sector to buffer
; 92   :     if (!FMD_ReadSector(sector, buffer, &sectorInfo, 1)) {

  000f4	e1dd30bc	 ldrh        r3, [sp, #0xC]
  000f8	e59f0088	 ldr         r0, [pc, #0x88]
  000fc	e0040493	 mul         r4, r3, r4
  00100	e2441001	 sub         r1, r4, #1
  00104	eb000000	 bl          NKDbgPrintfW
  00108	e3a03001	 mov         r3, #1
  0010c	e28d2010	 add         r2, sp, #0x10
  00110	e28d1fe6	 add         r1, sp, #0xE6, 30
  00114	e2440001	 sub         r0, r4, #1
  00118	eb000000	 bl          FMD_ReadSector
  0011c	e3500000	 cmp         r0, #0
  00120	1a000007	 bne         |$LN2@BLReadBoot|

; 93   :         OALMSG(OAL_ERROR, (L"ERROR: EBOOT!BLReadBootCfg: "
; 94   :             L"Flash sector %d read failed\r\n", sector
; 95   :         ));

  00124	e59f3058	 ldr         r3, [pc, #0x58]
  00128	e5933440	 ldr         r3, [r3, #0x440]
  0012c	e3130001	 tst         r3, #1
  00130	0a000008	 beq         |$cleanUp$46857|
  00134	e59f0044	 ldr         r0, [pc, #0x44]
  00138	e2441001	 sub         r1, r4, #1
  0013c	eb000000	 bl          NKDbgPrintfW

; 96   :             goto cleanUp;

  00140	ea000004	 b           |$cleanUp$46857|
  00144		 |$LN2@BLReadBoot|

; 97   :     }
; 98   : 
; 99   :     // Copy data to BOOT_CFG structure
; 100  :     memcpy(pBootCfg, buffer, sizeof(BOOT_CFG));        

  00144	e28d1fe6	 add         r1, sp, #0xE6, 30
  00148	e3a02090	 mov         r2, #0x90
  0014c	e1a00007	 mov         r0, r7
  00150	eb000000	 bl          memcpy

; 101  : 
; 102  :     // Done    
; 103  :     rc = TRUE;

  00154	e3a06001	 mov         r6, #1
  00158		 |$cleanUp$46857|

; 104  : 
; 105  : cleanUp:
; 106  :     if (hFMD != NULL) 
; 107  :     	FMD_Deinit(hFMD);

  00158	e1a00008	 mov         r0, r8
  0015c	eb000000	 bl          FMD_Deinit
  00160		 |$LN1@BLReadBoot|

; 108  :     	
; 109  :     return rc;

  00160	e59d0b98	 ldr         r0, [sp, #0xB98]
  00164	eb000000	 bl          __security_check_cookie

; 110  : }

  00168	e1a00006	 mov         r0, r6
  0016c	e3a0cc0b	 mov         r12, #0xB, 24
  00170	e38cc09c	 orr         r12, r12, #0x9C
  00174	e08dd00c	 add         sp, sp, r12
  00178	e8bd41f0	 ldmia       sp!, {r4 - r8, lr}
  0017c	e12fff1e	 bx          lr
  00180		 |$LN24@BLReadBoot|
  00180		 |$LN25@BLReadBoot|
  00180	00000000	 DCD         |??_C@_1HE@BDJAOKHO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAR?$AAe?$AAa?$AAd?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs@|
  00184		 |$LN26@BLReadBoot|
  00184	00000000	 DCD         |dpCurSettings|
  00188		 |$LN27@BLReadBoot|
  00188	00000000	 DCD         |??_C@_1DK@HPMHIIMH@?$AAB?$AAL?$AAR?$AAe?$AAa?$AAd?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AA?$DN?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  0018c		 |$LN28@BLReadBoot|
  0018c	00000000	 DCD         |??_C@_1IG@EBGBGDAI@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs?$AAh?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAb?$AAy?$AAt?$AAe@|
  00190		 |$LN29@BLReadBoot|
  00190	00000000	 DCD         |??_C@_1EE@MHCJNGAF@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAG?$AAe?$AAt?$AAI?$AAn?$AAf?$AAo?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN@|
  00194		 |$LN30@BLReadBoot|
  00194	00000000	 DCD         |??_C@_1DO@FFNONGBO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAI?$AAn?$AAi?$AAt?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN?$AA?6?$AA?$AA@|
  00198		 |$LN31@BLReadBoot|
  00198	00000000	 DCD         |g_ulFlashBase|
  0019c		 |$LN32@BLReadBoot|
  0019c	00000000	 DCD         |__security_cookie|
  001a0		 |$LN33@BLReadBoot|
  001a0	fffff464	 DCD         0xfffff464
  001a4		 |$M47023|

			 ENDP  ; |BLReadBootCfg|

	EXPORT	|__$ArrayPad$| [ DATA ]
	EXPORT	|BLWriteBootCfg|
	EXPORT	|??_C@_1HI@NMGONLPH@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa@| [ DATA ] ; `string'
	EXPORT	|??_C@_1HG@CNPKAHCG@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa@| [ DATA ] ; `string'
	EXPORT	|??_C@_1IE@IPHMEIA@?$AA?$AN?$AA?6?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF@| [ DATA ] ; `string'
	EXPORT	|??_C@_1IG@GHABCEAA@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs?$AAh?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAb?$AAy?$AAt?$AAe@| [ DATA ] ; `string'
	IMPORT	|FMD_WriteSector|
	IMPORT	|FMD_EraseBlock|
	IMPORT	|memset|

  00000			 AREA	 |.pdata|, PDATA
|$T47084| DCD	|$LN40@BLWriteBoo|
	DCD	0xc000a502

  00000			 AREA	 |.xdata|, DATA
|$T47080| DCD	0xffffffd8

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1HI@NMGONLPH@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "E", 0x0, "B", 0x0, "O", 0x0, "O", 0x0, "T", 0x0, "!"
	DCB	0x0, "B", 0x0, "L", 0x0, "W", 0x0, "r", 0x0, "i", 0x0, "t"
	DCB	0x0, "e", 0x0, "B", 0x0, "o", 0x0, "o", 0x0, "t", 0x0, "C"
	DCB	0x0, "f", 0x0, "g", 0x0, ":", 0x0, " ", 0x0, "F", 0x0, "l"
	DCB	0x0, "a", 0x0, "s", 0x0, "h", 0x0, " ", 0x0, "s", 0x0, "e"
	DCB	0x0, "c", 0x0, "t", 0x0, "o", 0x0, "r", 0x0, " ", 0x0, "%"
	DCB	0x0, "d", 0x0, " ", 0x0, "w", 0x0, "r", 0x0, "i", 0x0, "t"
	DCB	0x0, "e", 0x0, " ", 0x0, "f", 0x0, "a", 0x0, "i", 0x0, "l"
	DCB	0x0, "e", 0x0, "d", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1HG@CNPKAHCG@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "E", 0x0, "B", 0x0, "O", 0x0, "O", 0x0, "T", 0x0, "!"
	DCB	0x0, "B", 0x0, "L", 0x0, "W", 0x0, "r", 0x0, "i", 0x0, "t"
	DCB	0x0, "e", 0x0, "B", 0x0, "o", 0x0, "o", 0x0, "t", 0x0, "C"
	DCB	0x0, "f", 0x0, "g", 0x0, ":", 0x0, " ", 0x0, "F", 0x0, "l"
	DCB	0x0, "a", 0x0, "s", 0x0, "h", 0x0, " ", 0x0, "b", 0x0, "l"
	DCB	0x0, "o", 0x0, "c", 0x0, "k", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, " ", 0x0, "e", 0x0, "r", 0x0, "a", 0x0, "s", 0x0, "e"
	DCB	0x0, " ", 0x0, "f", 0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e"
	DCB	0x0, "d", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1IE@IPHMEIA@?$AA?$AN?$AA?6?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF@| DCB 0xd
	DCB	0x0, 0xa, 0x0, "E", 0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R"
	DCB	0x0, ":", 0x0, " ", 0x0, "E", 0x0, "B", 0x0, "O", 0x0, "O"
	DCB	0x0, "T", 0x0, "!", 0x0, "B", 0x0, "L", 0x0, "W", 0x0, "r"
	DCB	0x0, "i", 0x0, "t", 0x0, "e", 0x0, "B", 0x0, "o", 0x0, "o"
	DCB	0x0, "t", 0x0, "C", 0x0, "f", 0x0, "g", 0x0, ":", 0x0, " "
	DCB	0x0, "F", 0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d"
	DCB	0x0, " ", 0x0, "r", 0x0, "e", 0x0, "a", 0x0, "d", 0x0, " "
	DCB	0x0, "s", 0x0, "e", 0x0, "c", 0x0, "t", 0x0, "o", 0x0, "r"
	DCB	0x0, " ", 0x0, "%", 0x0, "d", 0x0, " ", 0x0, "f", 0x0, "r"
	DCB	0x0, "o", 0x0, "m", 0x0, " ", 0x0, "f", 0x0, "l", 0x0, "a"
	DCB	0x0, "s", 0x0, "h", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1IG@GHABCEAA@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs?$AAh?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAb?$AAy?$AAt?$AAe@| DCB "E"
	DCB	0x0, "R", 0x0, "R", 0x0, "O", 0x0, "R", 0x0, ":", 0x0, " "
	DCB	0x0, "F", 0x0, "l", 0x0, "a", 0x0, "s", 0x0, "h", 0x0, " "
	DCB	0x0, "s", 0x0, "e", 0x0, "c", 0x0, "t", 0x0, "o", 0x0, "r"
	DCB	0x0, " ", 0x0, "s", 0x0, "i", 0x0, "z", 0x0, "e", 0x0, " "
	DCB	0x0, "%", 0x0, "d", 0x0, " ", 0x0, "b", 0x0, "y", 0x0, "t"
	DCB	0x0, "e", 0x0, "s", 0x0, " ", 0x0, "b", 0x0, "i", 0x0, "g"
	DCB	0x0, "g", 0x0, "e", 0x0, "r", 0x0, " ", 0x0, "t", 0x0, "h"
	DCB	0x0, "a", 0x0, "t", 0x0, " ", 0x0, "s", 0x0, "u", 0x0, "p"
	DCB	0x0, "p", 0x0, "o", 0x0, "r", 0x0, "t", 0x0, "e", 0x0, "d"
	DCB	0x0, " ", 0x0, "%", 0x0, "d", 0x0, " ", 0x0, "b", 0x0, "y"
	DCB	0x0, "t", 0x0, "e", 0x0, "s", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__GSHandlerCheck|
  00004	00000000	 DCD         |$T47080|

  00008		 |BLWriteBootCfg| PROC

; 114  : {

  00008		 |$LN40@BLWriteBoo|
  00008	e92d4ff0	 stmdb       sp!, {r4 - r11, lr}
  0000c	e24ddfe7	 sub         sp, sp, #0xE7, 30
  00010		 |$M47081|
  00010	e1a0a000	 mov         r10, r0
  00014	e59f327c	 ldr         r3, [pc, #0x27C]
  00018	e5933000	 ldr         r3, [r3]
  0001c	e58d3398	 str         r3, [sp, #0x398]

; 115  :     BOOL rc = FALSE;
; 116  :     HANDLE hFMD;
; 117  :     PCI_REG_INFO regInfo;
; 118  :     FlashInfo flashInfo;
; 119  :     SectorInfo sectorInfo;
; 120  :     SECTOR_ADDR sector;
; 121  :     BLOCK_ID block;
; 122  :     UINT32 count, offset, length;
; 123  :     UINT8 buffer[2048];
; 124  :     UINT8 *pEBOOT;
; 125  :     
; 126  :     // EBOOT configuration is placed in last sector of image
; 127  :     regInfo.MemBase.Reg[0] = g_ulFlashBase;

  00020	e59f326c	 ldr         r3, [pc, #0x26C]

; 128  :     hFMD = FMD_Init(NULL, &regInfo, NULL);

  00024	e3a02000	 mov         r2, #0
  00028	e28d1018	 add         r1, sp, #0x18
  0002c	e5933000	 ldr         r3, [r3]
  00030	e3a00000	 mov         r0, #0
  00034	e3a08000	 mov         r8, #0
  00038	e58d3328	 str         r3, [sp, #0x328]
  0003c	eb000000	 bl          FMD_Init
  00040	e1b0b000	 movs        r11, r0

; 129  :     if (hFMD == NULL)

  00044	1a000006	 bne         |$LN14@BLWriteBoo|

; 130  : 	{
; 131  :         OALMSG(OAL_ERROR, (L"ERROR: FMD_Init call failed!\r\n"));

  00048	e59f322c	 ldr         r3, [pc, #0x22C]
  0004c	e5933440	 ldr         r3, [r3, #0x440]
  00050	e3130001	 tst         r3, #1
  00054	0a000079	 beq         |$LN1@BLWriteBoo|
  00058	e59f0230	 ldr         r0, [pc, #0x230]
  0005c	eb000000	 bl          NKDbgPrintfW

; 132  :         goto cleanUp;

  00060	ea000076	 b           |$LN1@BLWriteBoo|
  00064		 |$LN14@BLWriteBoo|

; 133  : 	}
; 134  : 
; 135  :     // Get flash info
; 136  :     if (!FMD_GetInfo(&flashInfo))

  00064	e28d0008	 add         r0, sp, #8
  00068	eb000000	 bl          FMD_GetInfo
  0006c	e3500000	 cmp         r0, #0
  00070	1a000006	 bne         |$LN13@BLWriteBoo|

; 137  : 	{
; 138  :         OALMSG(OAL_ERROR, (L"ERROR: FMD_GetInfo call failed!\r\n"));

  00074	e59f3200	 ldr         r3, [pc, #0x200]
  00078	e5933440	 ldr         r3, [r3, #0x440]
  0007c	e3130001	 tst         r3, #1
  00080	0a00006c	 beq         |$cleanUp$46896|
  00084	e59f0200	 ldr         r0, [pc, #0x200]
  00088	eb000000	 bl          NKDbgPrintfW

; 139  :         goto cleanUp;

  0008c	ea000069	 b           |$cleanUp$46896|
  00090		 |$LN13@BLWriteBoo|

; 140  : 	}
; 141  : 
; 142  :     // We can support only flash with sector size which fit to our buffer
; 143  :     if (flashInfo.wDataBytesPerSector > sizeof(buffer))

  00090	e1dd11b6	 ldrh        r1, [sp, #0x16]
  00094	e3510b02	 cmp         r1, #2, 22
  00098	9a000007	 bls         |$LN12@BLWriteBoo|

; 144  : 	{
; 145  :         OALMSG(OAL_ERROR, (L"ERROR: "
; 146  :             L"Flash sector size %d bytes bigger that supported %d bytes\r\n",
; 147  :             flashInfo.wDataBytesPerSector, sizeof(buffer) ));

  0009c	e59f31d8	 ldr         r3, [pc, #0x1D8]
  000a0	e5933440	 ldr         r3, [r3, #0x440]
  000a4	e3130001	 tst         r3, #1
  000a8	0a000062	 beq         |$cleanUp$46896|
  000ac	e59f01d4	 ldr         r0, [pc, #0x1D4]
  000b0	e3a02b02	 mov         r2, #2, 22
  000b4	eb000000	 bl          NKDbgPrintfW

; 148  :         goto cleanUp;

  000b8	ea00005e	 b           |$cleanUp$46896|
  000bc		 |$LN12@BLWriteBoo|

; 149  : 	}
; 150  : 
; 151  :     // Configuration is located in last sector of last EBOOT block
; 152  :     offset = IMAGE_XLDR_BOOTSEC_NAND_SIZE + IMAGE_EBOOT_BOOTSEC_NAND_SIZE; // 0x80000 + 0x40000
; 153  : 
; 154  :     // Skip X-Loader & EBOOT code & bad blocks
; 155  :     // Note that we also check the last eboot block in order to ensure it is good
; 156  :     block  = 0;
; 157  :     count = 0;

  000bc	e59d1010	 ldr         r1, [sp, #0x10]
  000c0	e3a04000	 mov         r4, #0
  000c4	e3a05000	 mov         r5, #0
  000c8		 |$LL11@BLWriteBoo|

; 158  :     while ((count < offset) && (block < flashInfo.dwNumBlocks))

  000c8	e59d300c	 ldr         r3, [sp, #0xC]
  000cc	e1540003	 cmp         r4, r3
  000d0	2a000007	 bcs         |$LN10@BLWriteBoo|

; 159  : 	{
; 160  :         if ((FMD_GetBlockStatus(block) & BLOCK_STATUS_BAD) == 0)

  000d4	e1a00004	 mov         r0, r4
  000d8	eb000000	 bl          FMD_GetBlockStatus
  000dc	e59d1010	 ldr         r1, [sp, #0x10]
  000e0	e3100002	 tst         r0, #2

; 161  : 		{
; 162  :             count += flashInfo.dwBytesPerBlock;
; 163  : 		}
; 164  :         block++;

  000e4	e2844001	 add         r4, r4, #1
  000e8	00855001	 addeq       r5, r5, r1
  000ec	e3550703	 cmp         r5, #3, 14
  000f0	3afffff4	 bcc         |$LL11@BLWriteBoo|
  000f4		 |$LN10@BLWriteBoo|

; 165  : 	}
; 166  : 
; 167  :     // We've incremented past the last eboot block in order to check it too
; 168  :     // Back up now, the previous block is the last one containing eboot and is good
; 169  :     block--; // 5
; 170  : 
; 171  :     // Need to copy off the block contents to RAM (minus the config sector)
; 172  :     pEBOOT = (UINT8*)IMAGE_WINCE_CODE_CA; // 0x80002000
; 173  :     length = flashInfo.dwBytesPerBlock - flashInfo.wDataBytesPerSector; // 0x20000 - 0x800

  000f4	e1dd31b6	 ldrh        r3, [sp, #0x16]
  000f8	e3a00102	 mov         r0, #2, 2

; 174  : 
; 175  :     memset((VOID*)pEBOOT, 0xFF, flashInfo.dwBytesPerBlock);

  000fc	e1a02001	 mov         r2, r1
  00100	e0417003	 sub         r7, r1, r3
  00104	e3a010ff	 mov         r1, #0xFF
  00108	e3800a02	 orr         r0, r0, #2, 20
  0010c	e2446001	 sub         r6, r4, #1
  00110	eb000000	 bl          memset

; 176  :     sector = block * flashInfo.wSectorsPerBlock; // 5 * 0x40 = 0x140

  00114	e1dd31b4	 ldrh        r3, [sp, #0x14]

; 177  :     offset = 0;
; 178  :     while (offset < length) 

  00118	e3e021fe	 mvn         r2, #0xFE, 2
  0011c	e3a04000	 mov         r4, #0
  00120	e0050693	 mul         r5, r3, r6
  00124	e2229d7f	 eor         r9, r2, #0x7F, 26
  00128	e3570000	 cmp         r7, #0
  0012c	0a00000b	 beq         |$LN7@BLWriteBoo|
  00130		 |$LL8@BLWriteBoo|

; 179  :     {
; 180  :         // When block read fail, there isn't what we can do more
; 181  :         if (!FMD_ReadSector(sector, pEBOOT + offset, &sectorInfo, 1)) 

  00130	e3a03001	 mov         r3, #1
  00134	e28d2000	 add         r2, sp, #0
  00138	e0441009	 sub         r1, r4, r9
  0013c	e1a00005	 mov         r0, r5
  00140	eb000000	 bl          FMD_ReadSector
  00144	e3500000	 cmp         r0, #0
  00148	0a000014	 beq         |$LN32@BLWriteBoo|

; 185  : 		}
; 186  : 
; 187  :         // Move to next sector
; 188  :         sector++;
; 189  :         offset += flashInfo.wDataBytesPerSector;

  0014c	e1dd31b6	 ldrh        r3, [sp, #0x16]
  00150	e2855001	 add         r5, r5, #1
  00154	e0844003	 add         r4, r4, r3
  00158	e1540007	 cmp         r4, r7
  0015c	3afffff3	 bcc         |$LL8@BLWriteBoo|
  00160		 |$LN7@BLWriteBoo|

; 190  :     }
; 191  :     //  Copy the config info into last sector of saved block in RAM
; 192  :     memcpy(pEBOOT + offset, pBootCfg, sizeof(BOOT_CFG)); 

  00160	e0440009	 sub         r0, r4, r9
  00164	e3a02090	 mov         r2, #0x90
  00168	e1a0100a	 mov         r1, r10
  0016c	eb000000	 bl          memcpy

; 193  : 
; 194  :     // Erase block
; 195  :     if (!FMD_EraseBlock(block))

  00170	e1a00006	 mov         r0, r6
  00174	eb000000	 bl          FMD_EraseBlock
  00178	e3500000	 cmp         r0, #0
  0017c	1a00000f	 bne         |$LN5@BLWriteBoo|

; 196  : 	{
; 197  :         OALMSG(OAL_ERROR, (L"ERROR: EBOOT!BLWriteBootCfg: Flash block %d erase failed\r\n", block));

  00180	e59f30f4	 ldr         r3, [pc, #0xF4]
  00184	e5933440	 ldr         r3, [r3, #0x440]
  00188	e3130001	 tst         r3, #1
  0018c	0a000029	 beq         |$cleanUp$46896|
  00190	e59f00ec	 ldr         r0, [pc, #0xEC]
  00194	e1a01006	 mov         r1, r6
  00198	eb000000	 bl          NKDbgPrintfW
  0019c	ea000025	 b           |$cleanUp$46896|
  001a0		 |$LN32@BLWriteBoo|

; 182  :         {
; 183  : 			OALMSG(OAL_ERROR, (L"\r\nERROR: EBOOT!BLWriteBootCfg: Failed read sector %d from flash\r\n", sector));

  001a0	e59f30d4	 ldr         r3, [pc, #0xD4]
  001a4	e5933440	 ldr         r3, [r3, #0x440]
  001a8	e3130001	 tst         r3, #1
  001ac	0a000021	 beq         |$cleanUp$46896|
  001b0	e59f00c8	 ldr         r0, [pc, #0xC8]
  001b4	e1a01005	 mov         r1, r5
  001b8	eb000000	 bl          NKDbgPrintfW

; 184  :             goto cleanUp;

  001bc	ea00001d	 b           |$cleanUp$46896|
  001c0		 |$LN5@BLWriteBoo|

; 198  :         goto cleanUp;
; 199  : 	}
; 200  : 
; 201  :     // Write contents of the save block + config sector back to flash
; 202  :     pEBOOT = (UINT8*)IMAGE_WINCE_CODE_CA;
; 203  :     length = flashInfo.dwBytesPerBlock;
; 204  : 
; 205  :     sector = block * flashInfo.wSectorsPerBlock;

  001c0	e1dd31b4	 ldrh        r3, [sp, #0x14]
  001c4	e59d7010	 ldr         r7, [sp, #0x10]

; 206  :     offset = 0;

  001c8	e3a05000	 mov         r5, #0
  001cc	e0040693	 mul         r4, r3, r6

; 207  :     while (offset < length)

  001d0	e3570000	 cmp         r7, #0
  001d4	0a000016	 beq         |$LN3@BLWriteBoo|
  001d8	e3e06000	 mvn         r6, #0
  001dc	e3a0a000	 mov         r10, #0
  001e0	e3a0e000	 mov         lr, #0
  001e4		 |$LL4@BLWriteBoo|

; 208  :     {
; 209  :         // Prepare sector info
; 210  :         memset(&sectorInfo, 0xFF, sizeof(sectorInfo));

  001e4	e58d6004	 str         r6, [sp, #4]

; 211  :         sectorInfo.bOEMReserved &= ~(OEM_BLOCK_READONLY|OEM_BLOCK_RESERVED);

  001e8	e5dd3004	 ldrb        r3, [sp, #4]
  001ec	e58d6000	 str         r6, [sp]

; 212  :         sectorInfo.dwReserved1 = 0;
; 213  :         sectorInfo.wReserved2 = 0;
; 214  :         // Write sector        
; 215  :         if (!FMD_WriteSector(sector, pEBOOT + offset, &sectorInfo, 1))

  001f0	e28d2000	 add         r2, sp, #0
  001f4	e20330fc	 and         r3, r3, #0xFC
  001f8	e5cd3004	 strb        r3, [sp, #4]
  001fc	e3a03001	 mov         r3, #1
  00200	e0451009	 sub         r1, r5, r9
  00204	e1a00004	 mov         r0, r4
  00208	e58da000	 str         r10, [sp]
  0020c	e1cde0b6	 strh        lr, [sp, #6]
  00210	eb000000	 bl          FMD_WriteSector
  00214	e3500000	 cmp         r0, #0
  00218	0a00000e	 beq         |$LN33@BLWriteBoo|

; 219  :             goto cleanUp;
; 220  : 		}
; 221  : 
; 222  :         // Move to next sector
; 223  :         sector++;
; 224  :         offset += flashInfo.wDataBytesPerSector;

  0021c	e1dd31b6	 ldrh        r3, [sp, #0x16]
  00220	e2844001	 add         r4, r4, #1
  00224	e3a0e000	 mov         lr, #0
  00228	e0855003	 add         r5, r5, r3
  0022c	e1550007	 cmp         r5, r7
  00230	3affffeb	 bcc         |$LL4@BLWriteBoo|
  00234		 |$LN3@BLWriteBoo|

; 225  :     }
; 226  : 
; 227  :     // Done    
; 228  :     rc = TRUE;

  00234	e3a08001	 mov         r8, #1
  00238		 |$cleanUp$46896|

; 229  : 
; 230  : cleanUp:
; 231  :     if (hFMD != NULL) 
; 232  :     	FMD_Deinit(hFMD);

  00238	e1a0000b	 mov         r0, r11
  0023c	eb000000	 bl          FMD_Deinit
  00240		 |$LN1@BLWriteBoo|

; 233  :     return rc;

  00240	e59d0398	 ldr         r0, [sp, #0x398]
  00244	eb000000	 bl          __security_check_cookie

; 234  : }

  00248	e1a00008	 mov         r0, r8
  0024c	e28ddfe7	 add         sp, sp, #0xE7, 30
  00250	e8bd4ff0	 ldmia       sp!, {r4 - r11, lr}
  00254	e12fff1e	 bx          lr
  00258		 |$LN33@BLWriteBoo|

; 216  : 		{
; 217  :             OALMSG(OAL_ERROR, (L"ERROR: EBOOT!BLWriteBootCfg: "
; 218  :                 L"Flash sector %d write failed\r\n", sector));

  00258	e59f301c	 ldr         r3, [pc, #0x1C]
  0025c	e5933440	 ldr         r3, [r3, #0x440]
  00260	e3130001	 tst         r3, #1
  00264	0afffff3	 beq         |$cleanUp$46896|
  00268	e59f0008	 ldr         r0, [pc, #8]
  0026c	e1a01004	 mov         r1, r4
  00270	eb000000	 bl          NKDbgPrintfW
  00274	eaffffef	 b           |$cleanUp$46896|
  00278		 |$LN41@BLWriteBoo|
  00278		 |$LN42@BLWriteBoo|
  00278	00000000	 DCD         |??_C@_1HI@NMGONLPH@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa@|
  0027c		 |$LN43@BLWriteBoo|
  0027c	00000000	 DCD         |dpCurSettings|
  00280		 |$LN44@BLWriteBoo|
  00280	00000000	 DCD         |??_C@_1IE@IPHMEIA@?$AA?$AN?$AA?6?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF@|
  00284		 |$LN45@BLWriteBoo|
  00284	00000000	 DCD         |??_C@_1HG@CNPKAHCG@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAE?$AAB?$AAO?$AAO?$AAT?$AA?$CB?$AAB?$AAL?$AAW?$AAr?$AAi?$AAt?$AAe?$AAB?$AAo?$AAo?$AAt?$AAC?$AAf?$AAg?$AA?3?$AA?5?$AAF?$AAl?$AAa@|
  00288		 |$LN46@BLWriteBoo|
  00288	00000000	 DCD         |??_C@_1IG@GHABCEAA@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAl?$AAa?$AAs?$AAh?$AA?5?$AAs?$AAe?$AAc?$AAt?$AAo?$AAr?$AA?5?$AAs?$AAi?$AAz?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAb?$AAy?$AAt?$AAe@|
  0028c		 |$LN47@BLWriteBoo|
  0028c	00000000	 DCD         |??_C@_1EE@MHCJNGAF@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAG?$AAe?$AAt?$AAI?$AAn?$AAf?$AAo?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN@|
  00290		 |$LN48@BLWriteBoo|
  00290	00000000	 DCD         |??_C@_1DO@FFNONGBO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAI?$AAn?$AAi?$AAt?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN?$AA?6?$AA?$AA@|
  00294		 |$LN49@BLWriteBoo|
  00294	00000000	 DCD         |g_ulFlashBase|
  00298		 |$LN50@BLWriteBoo|
  00298	00000000	 DCD         |__security_cookie|
  0029c		 |$M47082|

			 ENDP  ; |BLWriteBootCfg|

	EXPORT	|__$ArrayPad$| [ DATA ]
	EXPORT	|BLReserveBootBlocks|
	EXPORT	|??_C@_1FG@GECOJCBP@?$AA?5?$AAO?$AAo?$AAp?$AAs?$AA?0?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAm?$AAa?$AAr?$AAk?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AA?5?$AA?$CF?$AAd?$AA?5?$AA?9?$AA?5?$AAa?$AAs?$AA?5@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CK@FKCECPDI@?$AA?5?$AAS?$AAk?$AAi?$AAp?$AA?5?$AAb?$AAa?$AAd?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1HO@MDILHIPB@?$AAC?$AAh?$AAe?$AAc?$AAk?$AAi?$AAn?$AAg?$AA?5?$AAb?$AAo?$AAo?$AAt?$AAl?$AAo?$AAa?$AAd?$AAe?$AAr?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AAs?$AA?5?$AAa?$AAr?$AAe?$AA?5?$AAm@| [ DATA ] ; `string'
	IMPORT	|FMD_SetBlockStatus|
	IMPORT	|__rt_udiv|

  00000			 AREA	 |.pdata|, PDATA
|$T47120| DCD	|$LN21@BLReserveB|
	DCD	0xc0005202

  00000			 AREA	 |.xdata|, DATA
|$T47116| DCD	0xffffffec

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FG@GECOJCBP@?$AA?5?$AAO?$AAo?$AAp?$AAs?$AA?0?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAm?$AAa?$AAr?$AAk?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AA?5?$AA?$CF?$AAd?$AA?5?$AA?9?$AA?5?$AAa?$AAs?$AA?5@| DCB " "
	DCB	0x0, "O", 0x0, "o", 0x0, "p", 0x0, "s", 0x0, ",", 0x0, " "
	DCB	0x0, "c", 0x0, "a", 0x0, "n", 0x0, "'", 0x0, "t", 0x0, " "
	DCB	0x0, "m", 0x0, "a", 0x0, "r", 0x0, "k", 0x0, " ", 0x0, "b"
	DCB	0x0, "l", 0x0, "o", 0x0, "c", 0x0, "k", 0x0, " ", 0x0, "%"
	DCB	0x0, "d", 0x0, " ", 0x0, "-", 0x0, " ", 0x0, "a", 0x0, "s"
	DCB	0x0, " ", 0x0, "r", 0x0, "e", 0x0, "s", 0x0, "e", 0x0, "r"
	DCB	0x0, "v", 0x0, "e", 0x0, "d", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CK@FKCECPDI@?$AA?5?$AAS?$AAk?$AAi?$AAp?$AA?5?$AAb?$AAa?$AAd?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| DCB " "
	DCB	0x0, "S", 0x0, "k", 0x0, "i", 0x0, "p", 0x0, " ", 0x0, "b"
	DCB	0x0, "a", 0x0, "d", 0x0, " ", 0x0, "b", 0x0, "l", 0x0, "o"
	DCB	0x0, "c", 0x0, "k", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1HO@MDILHIPB@?$AAC?$AAh?$AAe?$AAc?$AAk?$AAi?$AAn?$AAg?$AA?5?$AAb?$AAo?$AAo?$AAt?$AAl?$AAo?$AAa?$AAd?$AAe?$AAr?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AAs?$AA?5?$AAa?$AAr?$AAe?$AA?5?$AAm@| DCB "C"
	DCB	0x0, "h", 0x0, "e", 0x0, "c", 0x0, "k", 0x0, "i", 0x0, "n"
	DCB	0x0, "g", 0x0, " ", 0x0, "b", 0x0, "o", 0x0, "o", 0x0, "t"
	DCB	0x0, "l", 0x0, "o", 0x0, "a", 0x0, "d", 0x0, "e", 0x0, "r"
	DCB	0x0, " ", 0x0, "b", 0x0, "l", 0x0, "o", 0x0, "c", 0x0, "k"
	DCB	0x0, "s", 0x0, " ", 0x0, "a", 0x0, "r", 0x0, "e", 0x0, " "
	DCB	0x0, "m", 0x0, "a", 0x0, "r", 0x0, "k", 0x0, "e", 0x0, "d"
	DCB	0x0, " ", 0x0, "a", 0x0, "s", 0x0, " ", 0x0, "r", 0x0, "e"
	DCB	0x0, "s", 0x0, "e", 0x0, "r", 0x0, "v", 0x0, "e", 0x0, "d"
	DCB	0x0, " ", 0x0, "(", 0x0, "N", 0x0, "u", 0x0, "m", 0x0, " "
	DCB	0x0, "=", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, ")", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__GSHandlerCheck|
  00004	00000000	 DCD         |$T47116|

  00008		 |BLReserveBootBlocks| PROC

; 238  : {

  00008		 |$LN21@BLReserveB|
  00008	e92d4070	 stmdb       sp!, {r4 - r6, lr}
  0000c	e24ddfe5	 sub         sp, sp, #0xE5, 30
  00010		 |$M47117|
  00010	e59f3134	 ldr         r3, [pc, #0x134]
  00014	e5933000	 ldr         r3, [r3]
  00018	e58d3390	 str         r3, [sp, #0x390]

; 239  :     BOOL rc = FALSE;
; 240  :     HANDLE hFMD;
; 241  :     PCI_REG_INFO regInfo;
; 242  :     FlashInfo flashInfo;
; 243  :     UINT32 size;
; 244  :     BLOCK_ID firstblock, lastblock;
; 245  :     UINT32 status;
; 246  :     
; 247  :     UNREFERENCED_PARAMETER(pBootCfg);
; 248  : 	//OALMSG(1, (L"BLReserveBootBlocks: start!\r\n"));
; 249  :     // Automatically mark the bootloader blocks as read-only/reserved
; 250  :     regInfo.MemBase.Reg[0] = g_ulFlashBase; // The device is connected to CS0 mapped to 0x0800-0000

  0001c	e59f3124	 ldr         r3, [pc, #0x124]

; 251  :     hFMD = FMD_Init(NULL, &regInfo, NULL);

  00020	e3a02000	 mov         r2, #0
  00024	e28d1010	 add         r1, sp, #0x10
  00028	e5933000	 ldr         r3, [r3]
  0002c	e3a00000	 mov         r0, #0
  00030	e3a04000	 mov         r4, #0
  00034	e58d3320	 str         r3, [sp, #0x320]
  00038	eb000000	 bl          FMD_Init
  0003c	e1b06000	 movs        r6, r0

; 252  :     if (hFMD == NULL)

  00040	1a000006	 bne         |$LN8@BLReserveB|

; 253  : 	{
; 254  :         OALMSG(OAL_ERROR, (L"ERROR: FMD_Init call failed!\r\n"));

  00044	e59f30f4	 ldr         r3, [pc, #0xF4]
  00048	e5933440	 ldr         r3, [r3, #0x440]
  0004c	e3130001	 tst         r3, #1
  00050	0a000030	 beq         |$LN1@BLReserveB|
  00054	e59f00e8	 ldr         r0, [pc, #0xE8]
  00058	eb000000	 bl          NKDbgPrintfW

; 255  :         goto cleanUp;

  0005c	ea00002d	 b           |$LN1@BLReserveB|
  00060		 |$LN8@BLReserveB|

; 256  : 	}
; 257  : 
; 258  :     // Get flash info
; 259  :     if (!FMD_GetInfo(&flashInfo))

  00060	e28d0000	 add         r0, sp, #0
  00064	eb000000	 bl          FMD_GetInfo
  00068	e3500000	 cmp         r0, #0
  0006c	1a000006	 bne         |$LN7@BLReserveB|

; 260  : 	{
; 261  :         OALMSG(OAL_ERROR, (L"ERROR: FMD_GetInfo call failed!\r\n"));

  00070	e59f30c8	 ldr         r3, [pc, #0xC8]
  00074	e5933440	 ldr         r3, [r3, #0x440]
  00078	e3130001	 tst         r3, #1
  0007c	0a000023	 beq         |$cleanUp$46943|
  00080	e59f00b4	 ldr         r0, [pc, #0xB4]
  00084	eb000000	 bl          NKDbgPrintfW

; 262  :         goto cleanUp;

  00088	ea000020	 b           |$cleanUp$46943|
  0008c		 |$LN7@BLReserveB|

; 263  : 	}
; 264  : 
; 265  :     //  Loop thru the bootloader blocks to ensure they are marked reserved
; 266  :     firstblock = 0;
; 267  :     size = IMAGE_BOOTLOADER_NAND_SIZE;
; 268  :     lastblock = ((size -1) / flashInfo.dwBytesPerBlock) + 1;

  0008c	e59d0008	 ldr         r0, [sp, #8]
  00090	e3e034ff	 mvn         r3, #0xFF, 8
  00094	e2231739	 eor         r1, r3, #0x39, 14
  00098	e3a04000	 mov         r4, #0
  0009c	eb000000	 bl          __rt_udiv
  000a0	e2805001	 add         r5, r0, #1

; 269  : 
; 270  :     OALLog(L"Checking bootloader blocks are marked as reserved (Num = %d)\r\n", lastblock-firstblock);

  000a4	e59f008c	 ldr         r0, [pc, #0x8C]
  000a8	e1a01005	 mov         r1, r5
  000ac	eb000000	 bl          NKDbgPrintfW

; 271  : 
; 272  :     while (firstblock < lastblock)

  000b0	e3550000	 cmp         r5, #0
  000b4	0a000014	 beq         |$LN5@BLReserveB|
  000b8		 |$LL6@BLReserveB|

; 273  : 	{
; 274  :         // If block is bad, we have to offset it
; 275  : 		// #define BLOCK_STATUS_UNKNOWN		0x01
; 276  : 		// #define BLOCK_STATUS_BAD			0x02
; 277  : 		// #define BLOCK_STATUS_READONLY	0x04
; 278  : 		// #define BLOCK_STATUS_RESERVED	0x08
; 279  :         status = FMD_GetBlockStatus(firstblock);

  000b8	e1a00004	 mov         r0, r4
  000bc	eb000000	 bl          FMD_GetBlockStatus

; 280  : 		//OALLog(L" Block %d status = 0x%x\r\n", firstblock, status);
; 281  :         // Skip bad blocks
; 282  :         if ((status & BLOCK_STATUS_BAD) != 0) 

  000c0	e3100002	 tst         r0, #2
  000c4	0a000004	 beq         |$LN4@BLReserveB|

; 283  : 		{
; 284  :             OALLog(L" Skip bad block %d\r\n", firstblock);

  000c8	e59f0064	 ldr         r0, [pc, #0x64]
  000cc	e1a01004	 mov         r1, r4
  000d0	eb000000	 bl          NKDbgPrintfW

; 285  :             // blocks marked bad would not have been written either, so don't include this 
; 286  :             // in the count of blocks that are reserved.
; 287  :             firstblock++;
; 288  :             lastblock++;

  000d4	e2855001	 add         r5, r5, #1

; 289  :             continue;

  000d8	ea000008	 b           |$LN2@BLReserveB|
  000dc		 |$LN4@BLReserveB|

; 290  : 		}
; 291  :         // Skip already reserved blocks
; 292  :         if ((status & BLOCK_STATUS_RESERVED) != 0) 

  000dc	e3100008	 tst         r0, #8

; 293  : 		{
; 294  :             firstblock++;
; 295  :             continue;

  000e0	1a000006	 bne         |$LN2@BLReserveB|

; 296  : 		}
; 297  :         // Mark block as read-only & reserved
; 298  :         if (!FMD_SetBlockStatus(firstblock, BLOCK_STATUS_READONLY|BLOCK_STATUS_RESERVED)) 

  000e4	e3a0100c	 mov         r1, #0xC
  000e8	e1a00004	 mov         r0, r4
  000ec	eb000000	 bl          FMD_SetBlockStatus
  000f0	e3500000	 cmp         r0, #0

; 299  : 		{
; 300  :             OALLog(L" Oops, can't mark block %d - as reserved\r\n", firstblock);

  000f4	059f0034	 ldreq       r0, [pc, #0x34]
  000f8	01a01004	 moveq       r1, r4
  000fc	0b000000	 bleq        NKDbgPrintfW
  00100		 |$LN2@BLReserveB|

; 301  : 		}
; 302  :         firstblock++;

  00100	e2844001	 add         r4, r4, #1
  00104	e1540005	 cmp         r4, r5
  00108	3affffea	 bcc         |$LL6@BLReserveB|
  0010c		 |$LN5@BLReserveB|

; 303  : 	}
; 304  :     // Done    
; 305  :     rc = TRUE;

  0010c	e3a04001	 mov         r4, #1
  00110		 |$cleanUp$46943|

; 306  : 	//OALMSG(1, (L"BLReserveBootBlocks: end!\r\n"));
; 307  :     //OALLog(L"\r\n");
; 308  : 
; 309  : cleanUp:
; 310  :     if (hFMD != NULL) FMD_Deinit(hFMD);

  00110	e1a00006	 mov         r0, r6
  00114	eb000000	 bl          FMD_Deinit
  00118		 |$LN1@BLReserveB|

; 311  :     return rc;

  00118	e59d0390	 ldr         r0, [sp, #0x390]
  0011c	eb000000	 bl          __security_check_cookie

; 312  : }

  00120	e1a00004	 mov         r0, r4
  00124	e28ddfe5	 add         sp, sp, #0xE5, 30
  00128	e8bd4070	 ldmia       sp!, {r4 - r6, lr}
  0012c	e12fff1e	 bx          lr
  00130		 |$LN22@BLReserveB|
  00130		 |$LN23@BLReserveB|
  00130	00000000	 DCD         |??_C@_1FG@GECOJCBP@?$AA?5?$AAO?$AAo?$AAp?$AAs?$AA?0?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAm?$AAa?$AAr?$AAk?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AA?5?$AA?$CF?$AAd?$AA?5?$AA?9?$AA?5?$AAa?$AAs?$AA?5@|
  00134		 |$LN24@BLReserveB|
  00134	00000000	 DCD         |??_C@_1CK@FKCECPDI@?$AA?5?$AAS?$AAk?$AAi?$AAp?$AA?5?$AAb?$AAa?$AAd?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  00138		 |$LN25@BLReserveB|
  00138	00000000	 DCD         |??_C@_1HO@MDILHIPB@?$AAC?$AAh?$AAe?$AAc?$AAk?$AAi?$AAn?$AAg?$AA?5?$AAb?$AAo?$AAo?$AAt?$AAl?$AAo?$AAa?$AAd?$AAe?$AAr?$AA?5?$AAb?$AAl?$AAo?$AAc?$AAk?$AAs?$AA?5?$AAa?$AAr?$AAe?$AA?5?$AAm@|
  0013c		 |$LN26@BLReserveB|
  0013c	00000000	 DCD         |??_C@_1EE@MHCJNGAF@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAG?$AAe?$AAt?$AAI?$AAn?$AAf?$AAo?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN@|
  00140		 |$LN27@BLReserveB|
  00140	00000000	 DCD         |dpCurSettings|
  00144		 |$LN28@BLReserveB|
  00144	00000000	 DCD         |??_C@_1DO@FFNONGBO@?$AAE?$AAR?$AAR?$AAO?$AAR?$AA?3?$AA?5?$AAF?$AAM?$AAD?$AA_?$AAI?$AAn?$AAi?$AAt?$AA?5?$AAc?$AAa?$AAl?$AAl?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?$CB?$AA?$AN?$AA?6?$AA?$AA@|
  00148		 |$LN29@BLReserveB|
  00148	00000000	 DCD         |g_ulFlashBase|
  0014c		 |$LN30@BLReserveB|
  0014c	00000000	 DCD         |__security_cookie|
  00150		 |$M47118|

			 ENDP  ; |BLReserveBootBlocks|

	EXPORT	|BLShowLogo|
	EXPORT	|??_C@_1CG@CLBPJHOF@?$AAB?$AAL?$AAS?$AAh?$AAo?$AAw?$AAL?$AAo?$AAg?$AAo?$AA?3?$AA?5?$AA0?$AAx?$AA?$CF?$AAx?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	IMPORT	|ShowLogo|

  00000			 AREA	 |.pdata|, PDATA
|$T47139| DCD	|$LN5@BLShowLogo|
	DCD	0x40000d01

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CG@CLBPJHOF@?$AAB?$AAL?$AAS?$AAh?$AAo?$AAw?$AAL?$AAo?$AAg?$AAo?$AA?3?$AA?5?$AA0?$AAx?$AA?$CF?$AAx?$AA?$AN?$AA?6?$AA?$AA@| DCB "B"
	DCB	0x0, "L", 0x0, "S", 0x0, "h", 0x0, "o", 0x0, "w", 0x0, "L"
	DCB	0x0, "o", 0x0, "g", 0x0, "o", 0x0, ":", 0x0, " ", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "x", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |BLShowLogo| PROC

; 316  : {

  00000		 |$LN5@BLShowLogo|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M47136|

; 317  :     //  Show the bootloader splashscreen
; 318  :     OALMSG(1, (L"BLShowLogo: 0x%x\r\n", g_ulFlashBase));

  00004	e59f4024	 ldr         r4, [pc, #0x24]
  00008	e59f001c	 ldr         r0, [pc, #0x1C]
  0000c	e5941000	 ldr         r1, [r4]
  00010	eb000000	 bl          NKDbgPrintfW

; 319  :     ShowLogo(g_ulFlashBase, IMAGE_XLDR_BOOTSEC_NAND_SIZE + IMAGE_EBOOT_BOOTSEC_NAND_SIZE);

  00014	e5940000	 ldr         r0, [r4]
  00018	e3a01703	 mov         r1, #3, 14
  0001c	eb000000	 bl          ShowLogo

; 320  : 
; 321  :     return TRUE;

  00020	e3a00001	 mov         r0, #1

; 322  : }

  00024	e8bd4010	 ldmia       sp!, {r4, lr}
  00028	e12fff1e	 bx          lr
  0002c		 |$LN6@BLShowLogo|
  0002c		 |$LN7@BLShowLogo|
  0002c	00000000	 DCD         |??_C@_1CG@CLBPJHOF@?$AAB?$AAL?$AAS?$AAh?$AAo?$AAw?$AAL?$AAo?$AAg?$AAo?$AA?3?$AA?5?$AA0?$AAx?$AA?$CF?$AAx?$AA?$AN?$AA?6?$AA?$AA@|
  00030		 |$LN8@BLShowLogo|
  00030	00000000	 DCD         |g_ulFlashBase|
  00034		 |$M47137|

			 ENDP  ; |BLShowLogo|

	END
